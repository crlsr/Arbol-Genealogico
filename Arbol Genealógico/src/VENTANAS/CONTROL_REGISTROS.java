/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package VENTANAS;

import EDD.List;
import EDD.Node;
import javax.swing.*;
import EDD.Tree;
import EDD.TreeNode;
import Extras.Funciones;
import Extras.Persona;
import JSON.LecturaJSON;
import java.awt.Image;
import java.awt.Toolkit;
import javax.swing.JOptionPane;
import org.graphstream.graph.implementations.MultiGraph;

/**
 *
 * @author marco
 */
public class CONTROL_REGISTROS extends javax.swing.JFrame {
    static LecturaJSON json;
    static Tree newTree;
    static Funciones func = new Funciones();

    /**
     * Creates new form A√ëADIR_MIEMBRO
     */

    public CONTROL_REGISTROS(Tree newTree, LecturaJSON json) {
        initComponents();
        this.setLocationRelativeTo(null);
        this.newTree = newTree;
        this.json = json;
        llenarDesplegable(); // Llamar al m√©todo para poblar el JComboBox
    }

    private void llenarDesplegable() {
        DESCENDIENTES_TITULONB.removeAllItems(); // LIMPIA EL DESPLEGABLE
        DESCENDIENTES_TITULONB.addItem("Selecciona un familiar"); // MUESTRA UN MENSAJE
        NOMBRE_APODO.removeAllItems(); // LIMPIA EL DESPLEGABLE
        NOMBRE_APODO.addItem("Selecciona un familiar"); // MUESTRA UN MENSAJE
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        REGRESAR = new javax.swing.JButton();
        INSTRUCCIONES = new javax.swing.JButton();
        INPUT_NAME = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        CERRAR = new javax.swing.JButton();
        BUSCAR_NOMBRE_APODO = new javax.swing.JButton();
        VER_ARBOL = new javax.swing.JButton();
        ICONO = new javax.swing.JLabel();
        DESCENDIENTES_TITULONB = new javax.swing.JComboBox<>();
        jLabel3 = new javax.swing.JLabel();
        INPUT_TITULONB = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        INPUT_GENERACION = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        INFO = new javax.swing.JTextArea();
        BUSCAR_TITULO = new javax.swing.JButton();
        BUSCAR_GENERACI√ìN = new javax.swing.JButton();
        INPUT_ANCESTROS = new javax.swing.JTextField();
        ANCESTROS = new javax.swing.JButton();
        NOMBRE_APODO = new javax.swing.JComboBox<>();
        FONDO = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("CONTROL DE REGISTROS");
        setIconImage(getIconImage());
        setUndecorated(true);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("CONTROL DE REGISTROS");
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 40, -1, -1));

        REGRESAR.setBackground(new java.awt.Color(0, 0, 0));
        REGRESAR.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        REGRESAR.setForeground(new java.awt.Color(255, 255, 255));
        REGRESAR.setText("REGRESAR");
        REGRESAR.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                REGRESARActionPerformed(evt);
            }
        });
        getContentPane().add(REGRESAR, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 500, -1, -1));

        INSTRUCCIONES.setBackground(new java.awt.Color(0, 0, 0));
        INSTRUCCIONES.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        INSTRUCCIONES.setForeground(new java.awt.Color(255, 255, 255));
        INSTRUCCIONES.setText("INSTRUCCIONES");
        INSTRUCCIONES.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                INSTRUCCIONESActionPerformed(evt);
            }
        });
        getContentPane().add(INSTRUCCIONES, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 500, -1, -1));

        INPUT_NAME.setBackground(new java.awt.Color(0, 0, 0));
        INPUT_NAME.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        INPUT_NAME.setForeground(new java.awt.Color(255, 255, 255));
        INPUT_NAME.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                INPUT_NAMEActionPerformed(evt);
            }
        });
        getContentPane().add(INPUT_NAME, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 110, 350, -1));

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setText("INGRESA EL NOMBRE O APODO DEL FAMILIAR:");
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 90, 340, -1));

        CERRAR.setBackground(new java.awt.Color(255, 0, 0));
        CERRAR.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        CERRAR.setForeground(new java.awt.Color(255, 255, 255));
        CERRAR.setText("X");
        CERRAR.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CERRARActionPerformed(evt);
            }
        });
        getContentPane().add(CERRAR, new org.netbeans.lib.awtextra.AbsoluteConstraints(660, 30, -1, -1));

        BUSCAR_NOMBRE_APODO.setBackground(new java.awt.Color(0, 0, 0));
        BUSCAR_NOMBRE_APODO.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        BUSCAR_NOMBRE_APODO.setForeground(new java.awt.Color(255, 255, 255));
        BUSCAR_NOMBRE_APODO.setText("BUSCAR POR NOMBRE/APODO");
        BUSCAR_NOMBRE_APODO.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BUSCAR_NOMBRE_APODOActionPerformed(evt);
            }
        });
        getContentPane().add(BUSCAR_NOMBRE_APODO, new org.netbeans.lib.awtextra.AbsoluteConstraints(449, 110, 250, -1));

        VER_ARBOL.setBackground(new java.awt.Color(0, 0, 0));
        VER_ARBOL.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        VER_ARBOL.setForeground(new java.awt.Color(255, 255, 255));
        VER_ARBOL.setText("VER ARBOL GENEAL√ìGICO");
        VER_ARBOL.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                VER_ARBOLActionPerformed(evt);
            }
        });
        getContentPane().add(VER_ARBOL, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 450, -1, -1));

        ICONO.setIcon(new javax.swing.ImageIcon(getClass().getResource("/IMAGENES/PERSONA.png"))); // NOI18N
        getContentPane().add(ICONO, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 430, -1, -1));

        DESCENDIENTES_TITULONB.setBackground(new java.awt.Color(0, 0, 0));
        DESCENDIENTES_TITULONB.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        DESCENDIENTES_TITULONB.setForeground(new java.awt.Color(255, 255, 255));
        DESCENDIENTES_TITULONB.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "OPCI√ìN 1", "OPCI√ìN 2", "OPCI√ìN 3", "OPCI√ìN 4" }));
        DESCENDIENTES_TITULONB.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                DESCENDIENTES_TITULONBActionPerformed(evt);
            }
        });
        getContentPane().add(DESCENDIENTES_TITULONB, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 340, 290, -1));

        jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("INGRESA EL TITULO NOBILIARIO:");
        getContentPane().add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 150, -1, -1));

        INPUT_TITULONB.setBackground(new java.awt.Color(0, 0, 0));
        INPUT_TITULONB.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        INPUT_TITULONB.setForeground(new java.awt.Color(255, 255, 255));
        INPUT_TITULONB.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                INPUT_TITULONBActionPerformed(evt);
            }
        });
        getContentPane().add(INPUT_TITULONB, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 170, 350, -1));

        jLabel4.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("INGRESA LA GENERACI√ìN:");
        getContentPane().add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 210, -1, -1));

        INPUT_GENERACION.setBackground(new java.awt.Color(0, 0, 0));
        INPUT_GENERACION.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        INPUT_GENERACION.setForeground(new java.awt.Color(255, 255, 255));
        INPUT_GENERACION.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                INPUT_GENERACIONActionPerformed(evt);
            }
        });
        getContentPane().add(INPUT_GENERACION, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 230, 350, -1));

        jLabel5.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(255, 255, 255));
        jLabel5.setText("ANCESTROS:");
        getContentPane().add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 270, -1, -1));

        INFO.setBackground(new java.awt.Color(0, 0, 0));
        INFO.setColumns(20);
        INFO.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        INFO.setForeground(new java.awt.Color(255, 255, 255));
        INFO.setRows(5);
        jScrollPane1.setViewportView(INFO);

        getContentPane().add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 330, 350, -1));

        BUSCAR_TITULO.setBackground(new java.awt.Color(0, 0, 0));
        BUSCAR_TITULO.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        BUSCAR_TITULO.setForeground(new java.awt.Color(255, 255, 255));
        BUSCAR_TITULO.setText("BUSCAR POR TITULO NOBILIARIO");
        BUSCAR_TITULO.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BUSCAR_TITULOActionPerformed(evt);
            }
        });
        getContentPane().add(BUSCAR_TITULO, new org.netbeans.lib.awtextra.AbsoluteConstraints(450, 170, -1, -1));

        BUSCAR_GENERACI√ìN.setBackground(new java.awt.Color(0, 0, 0));
        BUSCAR_GENERACI√ìN.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        BUSCAR_GENERACI√ìN.setForeground(new java.awt.Color(255, 255, 255));
        BUSCAR_GENERACI√ìN.setText("BUSCAR POR GENERACI√ìN");
        BUSCAR_GENERACI√ìN.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BUSCAR_GENERACI√ìNActionPerformed(evt);
            }
        });
        getContentPane().add(BUSCAR_GENERACI√ìN, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 230, -1, -1));

        INPUT_ANCESTROS.setBackground(new java.awt.Color(0, 0, 0));
        INPUT_ANCESTROS.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        INPUT_ANCESTROS.setForeground(new java.awt.Color(255, 255, 255));
        INPUT_ANCESTROS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                INPUT_ANCESTROSActionPerformed(evt);
            }
        });
        getContentPane().add(INPUT_ANCESTROS, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 290, 350, -1));

        ANCESTROS.setBackground(new java.awt.Color(0, 0, 0));
        ANCESTROS.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        ANCESTROS.setForeground(new java.awt.Color(255, 255, 255));
        ANCESTROS.setText("BUSCAR ANCESTROS");
        ANCESTROS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ANCESTROSActionPerformed(evt);
            }
        });
        getContentPane().add(ANCESTROS, new org.netbeans.lib.awtextra.AbsoluteConstraints(490, 290, -1, 30));

        NOMBRE_APODO.setBackground(new java.awt.Color(0, 0, 0));
        NOMBRE_APODO.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        NOMBRE_APODO.setForeground(new java.awt.Color(255, 255, 255));
        NOMBRE_APODO.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "OPCI√ìN 1", "OPCI√ìN 2", "OPCI√ìN 3", "OPCI√ìN 4" }));
        NOMBRE_APODO.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                NOMBRE_APODOActionPerformed(evt);
            }
        });
        getContentPane().add(NOMBRE_APODO, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 390, 290, -1));

        FONDO.setBackground(new java.awt.Color(0, 0, 0));
        FONDO.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        FONDO.setForeground(new java.awt.Color(255, 255, 255));
        FONDO.setIcon(new javax.swing.ImageIcon(getClass().getResource("/IMAGENES/FONDO.png"))); // NOI18N
        getContentPane().add(FONDO, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 720, 550));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void CERRARActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CERRARActionPerformed
        System.exit(0);
    }//GEN-LAST:event_CERRARActionPerformed

    public Image getIconImage() {
        Image icono = Toolkit.getDefaultToolkit().getImage(ClassLoader.getSystemResource("imagenes/ICONO_TRONO.png"));
        return icono;
    }
    private void REGRESARActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_REGRESARActionPerformed
        MENU M = new MENU(newTree, json);
        M.setVisible(true);
        this.setVisible(false);
    }//GEN-LAST:event_REGRESARActionPerformed

    private void BUSCAR_NOMBRE_APODOActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BUSCAR_NOMBRE_APODOActionPerformed
        try {
            DESCENDIENTES_TITULONB.removeAllItems();
            NOMBRE_APODO.removeAllItems();
            DESCENDIENTES_TITULONB.addItem("Selecciona un familiar");
            NOMBRE_APODO.addItem("Selecciona un familiar");
            String nombrePersona = INPUT_NAME.getText();
            if (!nombrePersona.isBlank()) {
                List<Persona> nombresymotes= func.searchByNameandMote(newTree, nombrePersona);
                if (nombresymotes.isEmpty()) {
                    JOptionPane.showMessageDialog(this, "No hay personas con este Nombre/Apodo üë§‚ùåÔ∏è");
                } else {
                    Node<Persona> aux = nombresymotes.getpFirst();
                    int num = 0;
                    String persona = "Nombre/Apodo: " + INPUT_NAME.getText() + "\n";
                    while (aux != null) {
                        num += 1;
                        if (aux.getData().getNumeral().equals("") || aux.getData().getNumeral() == null) {
                            persona += num + ". " + aux.getData().getFullName() + "\n";
                            NOMBRE_APODO.addItem(aux.getData().getFullName());
                        } else {
                            persona += num + ". " + aux.getData().getFullName() + ", " + aux.getData().getNumeral() + " of his name" + "\n";
                            NOMBRE_APODO.addItem(aux.getData().getFullName() + ", " + aux.getData().getNumeral() + " of his name");
                        }
                        aux = aux.getpNext();
                    }
                    INFO.setText(persona);
                }
            } 
            else {
                JOptionPane.showMessageDialog(this, "Debe ingresar el nombre de la persona que desea buscar üë§Ô∏è");
            }
            INPUT_NAME.setText("");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Ocurrio un error inesperado!!!");
        }
    }//GEN-LAST:event_BUSCAR_NOMBRE_APODOActionPerformed

    private void INSTRUCCIONESActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_INSTRUCCIONESActionPerformed
        JOptionPane.showMessageDialog(this, "üë§\nÔ∏è"
                + "üë§\nÔ∏è");
    }//GEN-LAST:event_INSTRUCCIONESActionPerformed

    private void VER_ARBOLActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_VER_ARBOLActionPerformed
        try {
            DESCENDIENTES_TITULONB.removeAllItems();
            NOMBRE_APODO.removeAllItems();
            DESCENDIENTES_TITULONB.addItem("Selecciona un familiar");
            NOMBRE_APODO.addItem("Selecciona un familiar");
            newTree.setGraph(new MultiGraph("√Årbol Geneal√≥gico"));
            newTree.mostrarArbol(newTree);
            func.appendGraph(newTree, newTree.getpRoot(), null);
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Ocurrio un error inesperado!!!");
        }
    }//GEN-LAST:event_VER_ARBOLActionPerformed

    private void DESCENDIENTES_TITULONBActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_DESCENDIENTES_TITULONBActionPerformed
        String seleccionado = (String) DESCENDIENTES_TITULONB.getSelectedItem();
        if (!"Selecciona un familiar".equals(seleccionado) && seleccionado != null) {
            if (seleccionado.contains(",")) {
                String[] Selected = seleccionado.split(", ");
                String[] Numeral = Selected[1].split(" ");
                Persona aux = new Persona(Selected[0], Numeral[0], "");
                TreeNode personaBuscada = newTree.getNombres().searchPersona(aux, false);
                JOptionPane.showMessageDialog(null, personaBuscada.getTinfo().generarDescripcion());
            }else{
                Persona aux = new Persona(seleccionado, "", "");
                TreeNode personaBuscada = newTree.getNombres().searchPersona(aux, false);
                JOptionPane.showMessageDialog(null, personaBuscada.getTinfo().generarDescripcion());
            }
        }
    }//GEN-LAST:event_DESCENDIENTES_TITULONBActionPerformed

    private void INPUT_TITULONBActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_INPUT_TITULONBActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_INPUT_TITULONBActionPerformed

    private void BUSCAR_TITULOActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BUSCAR_TITULOActionPerformed
        try {
            DESCENDIENTES_TITULONB.removeAllItems();
            NOMBRE_APODO.removeAllItems();
            DESCENDIENTES_TITULONB.addItem("Selecciona un familiar");
            NOMBRE_APODO.addItem("Selecciona un familiar");
            String titulinb = INPUT_TITULONB.getText();
            if (!titulinb.isBlank()) {
                List<Persona> listPersonas = func.constructListHeldTitle(newTree, titulinb);
                if (listPersonas.isEmpty()) {
                    JOptionPane.showMessageDialog(this, "No hay personas con este titulo nobiliario üë§‚ùåÔ∏è");
                } else {
                    Node<Persona> aux = listPersonas.getpFirst();
                    int num = 0;
                    String persona = "Titulo Nobiliario: " + INPUT_TITULONB.getText() + "\n";
                    while (aux != null) {
                        num += 1;
                        persona += num + ". " + aux.getData().getFullName() + ", " + aux.getData().getNumeral() + " of his name" + "\n";
                        DESCENDIENTES_TITULONB.addItem(aux.getData().getFullName() + ", " + aux.getData().getNumeral() + " of his name");
                        aux = aux.getpNext();
                    }
                    INFO.setText(persona);
                }
            } else {
                JOptionPane.showMessageDialog(this, "Debe ingresar el titulo nobilario de la persona que desea buscar üë§Ô∏è");
            }
            INPUT_TITULONB.setText("");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Ocurrio un error inesperado!!!");
        }
    }//GEN-LAST:event_BUSCAR_TITULOActionPerformed

    private void INPUT_ANCESTROSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_INPUT_ANCESTROSActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_INPUT_ANCESTROSActionPerformed

    private void ANCESTROSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ANCESTROSActionPerformed
        try {
            DESCENDIENTES_TITULONB.removeAllItems();
            NOMBRE_APODO.removeAllItems();
            DESCENDIENTES_TITULONB.addItem("Selecciona un familiar");
            NOMBRE_APODO.addItem("Selecciona un familiar");
            String nombre = INPUT_ANCESTROS.getText();
            Persona fatherPersona;
            if (nombre.contains(",")) {
                String[] partesNombre = nombre.split(", ");
                String numeral = partesNombre[1].split(" ")[0].trim();
                fatherPersona = new Persona(partesNombre[0].trim(), numeral.trim(), "");
            } else {
                fatherPersona = new Persona("", "", nombre.trim());
            }
            TreeNode persona = newTree.searchPersonaTree(fatherPersona);
            if (persona != null) {
                INFO.setText(func.constructAncestors(persona.getTinfo(), newTree));
            } else {
                JOptionPane.showMessageDialog(this, nombre + " no ha sido encontrado");
            }
            INPUT_ANCESTROS.setText("");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Ocurrio un error inesperado!!!");
        }
    }//GEN-LAST:event_ANCESTROSActionPerformed

    private void INPUT_GENERACIONActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_INPUT_GENERACIONActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_INPUT_GENERACIONActionPerformed

    private void BUSCAR_GENERACI√ìNActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BUSCAR_GENERACI√ìNActionPerformed
        try {
            DESCENDIENTES_TITULONB.removeAllItems();
            NOMBRE_APODO.removeAllItems();
            DESCENDIENTES_TITULONB.addItem("Selecciona un familiar");
            NOMBRE_APODO.addItem("Selecciona un familiar");
            String generacion = INPUT_GENERACION.getText();
            int gen = Integer.parseInt(generacion);
            if (!generacion.isBlank()) {
                List<Persona> Generacion = func.constructListGeneration(newTree, gen);
                if (Generacion.isEmpty()) {
                    JOptionPane.showMessageDialog(this, "No hay personas en esta generaci√≥n üë§‚ùåÔ∏è");
                } else {
                    Node<Persona> aux = Generacion.getpFirst();
                    int num = 0;
                    String persona = "Generaci√≥n: " + INPUT_GENERACION.getText() + "\n";
                    while (aux != null) {
                        num += 1;
                        if (aux.getData().getNumeral().equals("") || aux.getData().getNumeral() == null) {
                            persona += num + ". " + aux.getData().getFullName() + "\n";
                            DESCENDIENTES_TITULONB.addItem(aux.getData().getFullName());

                        } else {
                            persona += num + ". " + aux.getData().getFullName() + ", " + aux.getData().getNumeral() + " of his name" + "\n";
                            DESCENDIENTES_TITULONB.addItem(aux.getData().getFullName() + ", " + aux.getData().getNumeral() + " of his name");
                        }
                        aux = aux.getpNext();
                    }
                    INFO.setText(persona);
                }
            } else {
                JOptionPane.showMessageDialog(this, "Aseg√∫rese de ingresar un valor num√©rico üë§Ô∏è");
            }
            INPUT_GENERACION.setText("");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Ocurrio un error inesperado!!!");
        }
    }//GEN-LAST:event_BUSCAR_GENERACI√ìNActionPerformed

    private void NOMBRE_APODOActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_NOMBRE_APODOActionPerformed
        String seleccionado = (String) NOMBRE_APODO.getSelectedItem();
        if (!"Selecciona un familiar".equals(seleccionado) && seleccionado != null) {
            TreeNode personaBuscada;
            if (seleccionado.contains(",")) {
                String[] Selected = seleccionado.split(", ");
                String[] Numeral = Selected[1].split(" ");
                Persona aux = new Persona(Selected[0], Numeral[0], "");
                personaBuscada = newTree.getNombres().searchPersona(aux, false);
            }else{
                Persona aux = new Persona(seleccionado, "", "");
                personaBuscada = newTree.getNombres().searchPersona(aux, false);
            }
        func.mostrarDescendencia(personaBuscada,newTree);
        }
    }//GEN-LAST:event_NOMBRE_APODOActionPerformed

    private void INPUT_NAMEActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_INPUT_NAMEActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_INPUT_NAMEActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(CONTROL_REGISTROS.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(CONTROL_REGISTROS.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(CONTROL_REGISTROS.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(CONTROL_REGISTROS.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new CONTROL_REGISTROS(newTree, json).setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton ANCESTROS;
    private javax.swing.JButton BUSCAR_GENERACI√ìN;
    private javax.swing.JButton BUSCAR_NOMBRE_APODO;
    private javax.swing.JButton BUSCAR_TITULO;
    private javax.swing.JButton CERRAR;
    private javax.swing.JComboBox<String> DESCENDIENTES_TITULONB;
    private javax.swing.JLabel FONDO;
    private javax.swing.JLabel ICONO;
    private javax.swing.JTextArea INFO;
    private javax.swing.JTextField INPUT_ANCESTROS;
    private javax.swing.JTextField INPUT_GENERACION;
    private javax.swing.JTextField INPUT_NAME;
    private javax.swing.JTextField INPUT_TITULONB;
    private javax.swing.JButton INSTRUCCIONES;
    private javax.swing.JComboBox<String> NOMBRE_APODO;
    private javax.swing.JButton REGRESAR;
    private javax.swing.JButton VER_ARBOL;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JScrollPane jScrollPane1;
    // End of variables declaration//GEN-END:variables
}
